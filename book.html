<!DOCTYPE html>
<html lang="uz">
<head>
<meta charset="UTF-8">
<title>Community | Nightfall</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{margin:0;padding:0;box-sizing:border-box}
body{
 background:#050505;
 color:#fff;
 font-family:Consolas,monospace;
 overflow:hidden;
}
canvas{position:fixed;inset:0;z-index:-1}

/* top */
.top{
 position:fixed;top:0;left:0;width:100%;
 padding:10px 20px;
 display:flex;
 justify-content:space-between;
 align-items:center;
 background:rgba(0,0,0,.6);
 border-bottom:1px solid #222;
}
.top img{
 width:36px;height:36px;
 border-radius:50%;
 cursor:pointer;
}

/* chat */
.chat{
 margin-top:60px;
 height:calc(100vh - 60px);
 max-width:900px;
 margin-inline:auto;
 display:flex;
 flex-direction:column;
 border-left:1px solid #222;
 border-right:1px solid #222;
}
.messages{
 flex:1;
 overflow-y:auto;
 padding:20px;
}
.msg{
 display:flex;
 gap:10px;
 margin-bottom:14px;
}
.msg img{
 width:36px;height:36px;
 border-radius:50%;
}
.msg .box span{
 color:#0f0;
 font-size:13px;
}
.msg .box p{
 background:#0c0c0c;
 border:1px solid #222;
 padding:6px 10px;
 margin-top:4px;
 max-width:75%;
}

/* input */
.input{
 display:flex;
 border-top:1px solid #222;
}
.input input{
 flex:1;
 background:#000;
 border:none;
 color:#fff;
 padding:14px;
 outline:none;
}
.input button{
 background:#111;
 border:none;
 color:#fff;
 padding:0 18px;
 cursor:pointer;
}
.input button:hover{background:#222}

/* emoji */
.emoji{
 position:absolute;
 bottom:80px;
 right:20px;
 background:#000;
 border:1px solid #333;
 padding:10px;
 display:none;
}
.emoji span{
 font-size:20px;
 padding:4px;
 cursor:pointer;
}

/* profile modal */
.profile{
 position:fixed;
 inset:0;
 background:rgba(0,0,0,.85);
 display:none;
 justify-content:center;
 align-items:center;
}
.profile-box{
 background:#0b0b0b;
 border:1px solid #222;
 padding:20px;
 width:300px;
 text-align:center;
}
.profile-box img{
 width:80px;height:80px;
 border-radius:50%;
 margin-bottom:10px;
}
.profile-box input,textarea{
 width:100%;
 background:#000;
 border:1px solid #333;
 color:#fff;
 padding:8px;
 margin:6px 0;
}
.profile-box button{
 margin-top:10px;
 width:100%;
 padding:8px;
 background:#111;
 border:1px solid #333;
 color:#fff;
 cursor:pointer;
}
</style>
</head>
<body>

<canvas id="bg"></canvas>

<div class="top">
 <div>COMMUNITY</div>
 <img id="topAvatar" onclick="openProfile()">
</div>

<div class="chat">
 <div class="messages" id="messages"></div>
 <div class="input">
  <input id="msg" placeholder="Xabar yozing...">
  <button onclick="toggleEmoji()">ðŸ˜€</button>
  <button onclick="send()">SEND</button>
 </div>
</div>

<div class="emoji" id="emoji">
 <span onclick="add('ðŸ˜€')">ðŸ˜€</span>
 <span onclick="add('ðŸ”¥')">ðŸ”¥</span>
 <span onclick="add('ðŸ’»')">ðŸ’»</span>
 <span onclick="add('âš¡')">âš¡</span>
</div>

<!-- PROFILE -->
<div class="profile" id="profile">
 <div class="profile-box">
  <img id="pAvatar">
  <input id="pName" placeholder="Ism">
  <textarea id="pBio" placeholder="Bio"></textarea>
  <button onclick="saveProfile()">SAVE</button>
 </div>
</div>

<script>
/* PROFILE */
let user={
 name:localStorage.getItem("name")||"Nightfall",
 bio:localStorage.getItem("bio")||"Hacker Community",
 avatar:localStorage.getItem("avatar")||
 "https://i.imgur.com/8Km9tLL.png"
};

function loadProfile(){
 topAvatar.src=user.avatar;
 pAvatar.src=user.avatar;
 pName.value=user.name;
 pBio.value=user.bio;
}
loadProfile();

function openProfile(){
 profile.style.display="flex";
}
function saveProfile(){
 user.name=pName.value;
 user.bio=pBio.value;
 localStorage.setItem("name",user.name);
 localStorage.setItem("bio",user.bio);
 profile.style.display="none";
}

/* CHAT */
function send(){
 if(msg.value.trim()=="")return;
 let m=document.createElement("div");
 m.className="msg";
 m.innerHTML=`
  <img src="${user.avatar}">
  <div class="box">
   <span>${user.name}</span>
   <p>${msg.value}</p>
  </div>`;
 messages.appendChild(m);
 msg.value="";
 messages.scrollTop=99999;
}

/* emoji */
function toggleEmoji(){
 emoji.style.display=emoji.style.display=="block"?"none":"block";
}
function add(e){msg.value+=e}

/* particles */
const c=bg,ctx=c.getContext("2d");
function r(){c.width=innerWidth;c.height=innerHeight}
r();onresize=r;
let p=[];
onmousemove=e=>{
 for(let i=0;i<2;i++)
 p.push({x:e.clientX,y:e.clientY,vx:Math.random()-.5,vy:Math.random()-.5,l:60});
}
(function a(){
 ctx.clearRect(0,0,c.width,c.height);
 p.forEach((o,i)=>{
  o.x+=o.vx;o.y+=o.vy;o.l--;
  ctx.fillStyle="rgba(255,255,255,.5)";
  ctx.fillRect(o.x,o.y,2,2);
  if(o.l<=0)p.splice(i,1);
 });
 requestAnimationFrame(a);
})();
</script>

</body>
</html>
